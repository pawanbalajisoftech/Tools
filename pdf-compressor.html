<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PDF Compressor – 100% Client-Side</title>
  <meta name="description" content="Compress PDF files in your browser. No upload. Choose quality, DPI, grayscale, and page ranges. SEO & mobile-friendly with ad placements." />
  <meta name="keywords" content="PDF, compressor, reduce PDF size, compress PDF online, client side, privacy" />
  <meta name="robots" content="index, follow" />
  <link rel="canonical" href="https://example.com/pdf-compressor" />
  <!-- Open Graph -->
  <meta property="og:type" content="website" />
  <meta property="og:title" content="PDF Compressor – 100% Client-Side" />
  <meta property="og:description" content="Compress PDFs privately in your browser. Control quality, DPI, grayscale, and more." />
  <meta property="og:image" content="https://example.com/og-image.png" />
  <meta property="og:url" content="https://example.com/pdf-compressor" />
  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="PDF Compressor – 100% Client-Side" />
  <meta name="twitter:description" content="Compress PDFs privately in your browser with full control." />
  <meta name="twitter:image" content="https://example.com/og-image.png" />

  <!-- Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "SoftwareApplication",
    "name": "PDF Compressor (Client-Side)",
    "applicationCategory": "UtilitiesApplication",
    "operatingSystem": "Web",
    "description": "Compress PDF files entirely in the browser. No server uploads. Options for quality, DPI, grayscale, and page range.",
    "offers": {"@type": "Offer", "price": "0", "priceCurrency": "USD"}
  }
  </script>

  <!-- TailwindCSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .ad-slot { background: #f8fafc; border: 1px dashed #cbd5e1; min-height: 90px; display:flex; align-items:center; justify-content:center; font-size:.9rem; color:#64748b; }
    .sr-live { position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); border:0; }
    progress { width: 100%; height: 12px; border-radius: 9999px; overflow: hidden; }
    progress::-webkit-progress-bar { background-color: #e5e7eb; border-radius: 9999px; }
    progress::-webkit-progress-value { background-color: #3b82f6; border-radius: 9999px; }
    progress::-moz-progress-bar { background-color: #3b82f6; border-radius: 9999px; }
  </style>
</head>
<body class="bg-white text-slate-800 antialiased">
  <header class="border-b bg-white/80 backdrop-blur sticky top-0 z-30">
    <div class="max-w-6xl mx-auto px-4 py-4 flex items-center justify-between">
      <a href="#" class="font-extrabold text-xl tracking-tight">PDF <span class="text-blue-600">Compressor</span></a>
      <nav class="hidden md:flex gap-6 text-sm">
        <a href="#features" class="hover:text-blue-600">Features</a>
        <a href="#how" class="hover:text-blue-600">How it works</a>
        <a href="#faq" class="hover:text-blue-600">FAQ</a>
      </nav>
    </div>
  </header>

  <main class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8 grid grid-cols-1 lg:grid-cols-12 gap-6">
    <aside class="lg:col-span-3 order-last lg:order-first space-y-6">
      <div class="ad-slot rounded-2xl shadow-sm">Left Rail Ad 300×600</div>
      <div class="ad-slot rounded-2xl shadow-sm">Left Sticky / Sponsor</div>
    </aside>

    <section class="lg:col-span-6">
      <h1 class="text-3xl sm:text-4xl font-extrabold tracking-tight mb-2">Compress PDFs privately in your browser</h1>
      <p class="text-slate-600 mb-6">No file ever leaves your device. Choose quality, DPI, grayscale, and page ranges. Perfect for email limits and fast sharing.</p>

      <form id="compressorForm" class="space-y-5" autocomplete="on">
        <div>
          <label for="fileInput" class="block text-sm font-medium mb-2">Select a PDF</label>
          <input id="fileInput" name="file" type="file" accept="application/pdf" class="block w-full text-sm file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100" required />
          <button id="uploadBtn" type="button" class="mt-3 px-4 py-2 rounded-xl bg-emerald-600 text-white font-semibold shadow hover:bg-emerald-700 hidden">Upload</button>
          <div class="mt-3">
            <progress id="uploadProgress" value="0" max="100" aria-label="Upload progress"></progress>
            <div class="text-xs text-slate-500 mt-1" id="uploadStatus">Waiting for file…</div>
          </div>
        </div>

        <!-- Options -->
        <fieldset class="grid grid-cols-1 sm:grid-cols-2 gap-4 p-4 border rounded-2xl">
          <legend class="px-2 text-sm font-semibold">Compression Options</legend>
          <div>
            <label class="block text-sm font-medium mb-1" for="mode">Mode</label>
            <select id="mode" class="w-full rounded-xl border-slate-300">
              <option value="raster">Smaller size (rasterize pages)</option>
              <option value="copy">Keep vectors/text (fast copy)</option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-medium mb-1" for="quality">JPEG Quality</label>
            <input id="quality" type="range" min="0.2" max="0.95" step="0.05" value="0.7" class="w-full" />
          </div>
          <div>
            <label class="block text-sm font-medium mb-1" for="dpi">Render DPI</label>
            <select id="dpi" class="w-full rounded-xl border-slate-300">
              <option>72</option>
              <option selected>110</option>
              <option>150</option>
              <option>200</option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-medium mb-1" for="grayscale">
              <input id="grayscale" type="checkbox" class="mr-2 align-middle"> Grayscale images
            </label>
          </div>
          <div class="sm:col-span-2">
            <label class="block text-sm font-medium mb-1" for="pageRange">Page Range</label>
            <input id="pageRange" type="text" placeholder="e.g. 1-3,5,9" class="w-full rounded-xl border-slate-300" />
          </div>
          <div class="sm:col-span-2">
            <label class="block text-sm font-medium mb-1" for="stripMeta">
              <input id="stripMeta" type="checkbox" class="mr-2 align-middle" checked> Strip metadata/XMP
            </label>
          </div>
        </fieldset>

        <div class="flex flex-col sm:flex-row gap-3">
          <button id="startBtn" type="submit" class="inline-flex items-center justify-center px-5 py-3 rounded-2xl bg-blue-600 text-white font-semibold shadow hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed" disabled>Compress PDF</button>
          <button id="resetBtn" type="button" class="px-4 py-3 rounded-2xl border font-medium">Reset</button>
        </div>

        <div id="processingWrap" class="hidden">
          <div class="mt-2 text-sm font-medium">Processing</div>
          <progress id="processProgress" value="0" max="100"></progress>
          <div id="processStatus" class="text-xs text-slate-500 mt-1">Preparing…</div>
        </div>

        <div id="result" class="hidden mt-4 border rounded-2xl p-4">
          <div class="flex items-center justify-between gap-3 flex-wrap">
            <div>
              <div class="text-sm text-slate-500">Original → Compressed</div>
              <div class="text-lg font-semibold" id="sizeReport">–</div>
            </div>
            <a id="downloadLink" href="#" download class="inline-flex items-center px-4 py-2 rounded-2xl bg-emerald-600 text-white font-semibold shadow hover:bg-emerald-700">Download compressed PDF</a>
          </div>
        </div>
      </form>
    </section>

    <aside class="lg:col-span-3 space-y-6">
      <div class="ad-slot rounded-2xl shadow-sm">Right Rail Ad 300×250</div>
      <div class="ad-slot rounded-2xl shadow-sm">Affiliate Cards</div>
    </aside>
  </main>

  <footer class="border-t">
    <div class="max-w-6xl mx-auto px-4 py-8 text-sm text-slate-500 flex flex-col sm:flex-row items-center justify-between gap-4">
      <div>© <span id="year"></span> PDF Compressor. All rights reserved.</div>
      <div class="ad-slot w-full sm:w-auto px-4 py-2 rounded-xl">Footer Banner 728×90</div>
    </div>
  </footer>

  <!-- Libraries -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>

  <script>
  (function(){
    const $ = (id) => document.getElementById(id);
    const fmtSize = (b) => {
      if (!Number.isFinite(b)) return '–';
      const units = ['B','KB','MB','GB'];
      let i = 0, n = b;
      while (n >= 1024 && i < units.length-1) { n /= 1024; i++; }
      return n.toFixed(n < 10 && i > 0 ? 2 : 1) + ' ' + units[i];
    };

    const yearEl = $('year');
    yearEl.textContent = new Date().getFullYear();

    const fileInput = $('fileInput');
    const uploadBtn = $('uploadBtn');
    const uploadProgress = $('uploadProgress');
    const uploadStatus = $('uploadStatus');
    const processWrap = $('processingWrap');
    const processProgress = $('processProgress');
    const processStatus = $('processStatus');
    const result = $('result');
    const sizeReport = $('sizeReport');
    const downloadLink = $('downloadLink');
    const startBtn = $('startBtn');
    const resetBtn = $('resetBtn');

    let selectedFile = null;
    let originalSize = 0;

    fileInput.addEventListener('change', (e) => {
      const file = e.target.files && e.target.files[0];
      if (!file) return;
      selectedFile = file;
      originalSize = file.size;
      uploadProgress.value = 0;
      uploadStatus.textContent = 'Ready to upload…';
      uploadBtn.classList.remove('hidden');
      startBtn.disabled = true;
    });

    uploadBtn.addEventListener('click', () => {
      if (!selectedFile) return;
      uploadBtn.disabled = true;
      uploadStatus.textContent = 'Uploading…';
      let loaded = 0;
      const step = selectedFile.size / 50;
      const interval = setInterval(() => {
        loaded += step;
        if (loaded >= selectedFile.size) {
          loaded = selectedFile.size;
          clearInterval(interval);
          uploadProgress.value = 100;
          uploadStatus.textContent = `File uploaded successfully: ${selectedFile.name} • ${fmtSize(originalSize)}`;
          uploadBtn.disabled = false;
          uploadBtn.classList.add('hidden');
          startBtn.disabled = false;
        } else {
          const pct = Math.round((loaded / selectedFile.size) * 100);
          uploadProgress.value = pct;
          uploadStatus.textContent = `Uploading… ${pct}%`;
        }
      }, 60);
    });

    resetBtn.addEventListener('click', () => {
      document.getElementById('compressorForm').reset();
      fileInput.value = '';
      uploadProgress.value = 0; uploadStatus.textContent = 'Waiting for file…';
      processWrap.classList.add('hidden');
      result.classList.add('hidden');
      uploadBtn.classList.add('hidden');
      startBtn.disabled = true;
    });

    function parsePageRange(input, total) {
      if (!input) return Array.from({length: total}, (_, i) => i + 1);
      const parts = input.split(',').map(s => s.trim()).filter(Boolean);
      const pages = new Set();
      for (const p of parts) {
        if (/^\d+$/.test(p)) {
          const n = parseInt(p, 10);
          if (n >= 1 && n <= total) pages.add(n);
        } else if (/^(\d+)-(\d+)$/.test(p)) {
          const [, a, b] = p.match(/(\d+)-(\d+)/);
          let start = parseInt(a,10), end = parseInt(b,10);
          if (start > end) [start, end] = [end, start];
          for (let i = start; i <= end; i++) if (i >=1 && i <= total) pages.add(i);
        }
      }
      return Array.from(pages).sort((x,y)=>x-y);
    }

    async function toGrayscale(canvas) {
      const ctx = canvas.getContext('2d');
      const img = ctx.getImageData(0, 0, canvas.width, canvas.height);
      const data = img.data;
      for (let i = 0; i < data.length; i += 4) {
        const r = data[i], g = data[i+1], b = data[i+2];
        const y = 0.299*r + 0.587*g + 0.114*b;
        data[i] = data[i+1] = data[i+2] = y;
      }
      ctx.putImageData(img, 0, 0);
    }

    async function compressRaster(arrayBuffer, opts) {
      const { quality, dpi, grayscale, pageRange } = opts;
      const loadingTask = pdfjsLib.getDocument({ data: arrayBuffer });
      const pdf = await loadingTask.promise;
      const doc = await PDFLib.PDFDocument.create();
      const totalPages = pdf.numPages;
      const pagesToDo = parsePageRange(pageRange, totalPages);
      let done = 0;
      for (const pageNum of pagesToDo) {
        processStatus.textContent = `Rendering page ${pageNum} of ${totalPages}…`;
        const page = await pdf.getPage(pageNum);
        const viewport = page.getViewport({ scale: dpi/72 });
        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d', { willReadFrequently: grayscale });
        canvas.width = Math.max(1, Math.floor(viewport.width));
        canvas.height = Math.max(1, Math.floor(viewport.height));
        await page.render({ canvasContext: ctx, viewport }).promise;
        if (grayscale) await toGrayscale(canvas);

        const dataUrl = canvas.toDataURL('image/jpeg', quality);
        const jpgBytes = await (await fetch(dataUrl)).arrayBuffer();
       
